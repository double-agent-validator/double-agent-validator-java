{"version":3,"sources":["webpack:///webpack/bootstrap 280fa151236dff2b3195","webpack:///external \"@angular/core\"","webpack:///./src/validator.service.ts","webpack:///./src/definitions-loader.service.ts","webpack:///external \"@angular/http\"","webpack:///external \"lodash\"","webpack:///./src/validator.module.ts","webpack:///./src/ng2-factory.service.ts","webpack:///./src/remote-loaders/angular2-remote-loader.ts","webpack:///external \"ajv\"","webpack:///external \"rxjs/add/operator/toPromise\"","webpack:///./src/index.ts"],"names":[],"mappings":"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","file":"double-agent-validator.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 280fa151236dff2b3195","module.exports = require(\"@angular/core\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/core\"\n// module id = 0\n// module chunks = 0","import { Injectable, Optional } from '@angular/core';\nimport { ValidationResult } from './models';\nimport * as ajvNsAndConstructor from 'ajv';\nimport * as _ from 'lodash';\n\n@Injectable()\nexport class DoubleAgentValidator {\n  private noErrorResult: ValidationResult = { hasErrors: false, errors: null };\n  private _ajv: ajvNsAndConstructor.Ajv;\n\n  constructor(/*@Optional() private _ajv: ajvNsAndConstructor.Ajv*/) {\n  }\n\n  get ajv(): ajvNsAndConstructor.Ajv {\n    return this._ajv;\n  }\n\n  validate(schemaName: string, data: any): ValidationResult {\n    let result: boolean = this.ajv.validate(schemaName, data);\n\n    if (result) {\n      return this.noErrorResult;\n    } else {\n      return {\n        hasErrors: true,\n        errors: this.ajv.errors\n      };\n    }\n  }\n\n  get schemas(): string[] {\n    return _.map(this.ajv['_schemas'], (schema) => schema['id']);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/validator.service.ts","\nimport { Injectable } from '@angular/core';\nimport { RemoteLoader } from './models/remote-loader';\nimport * as _ from 'lodash';\nimport * as ajvNsAndConstructor from 'ajv';\n@Injectable()\nexport class ValidatorDefinitionsLoader {\n  private _ajv: ajvNsAndConstructor.Ajv = new ajvNsAndConstructor({allErrors: true, v5: true});\n\n  get ajv(): ajvNsAndConstructor.Ajv {\n    return this._ajv;\n  }\n  constructor(private remoteLoader: RemoteLoader) {\n  }\n\n  load(window: Window, url: string, namespaces: string[]): Promise<ajvNsAndConstructor.Ajv> {\n    return this.remoteLoader.getScript(url).then((scriptContent) => {\n      return this.loadScript(window, scriptContent, namespaces);\n    });\n  }\n\n  private loadScript(window: Window, script: string, schemas: string[]): Promise<ajvNsAndConstructor.Ajv> {\n    return new Promise<ajvNsAndConstructor.Ajv>((resolve, reject) => {\n      try {\n        let loadSchemaCall = (schemas.length === 1)\n          ? `DoubleAgent.JsonSchemaValidator.load(${schemas[0]}, ajv);`\n          : `DoubleAgent.JsonSchemaValidator.loadMultiple([${schemas.join(',')}], ajv);`;\n        window['ajv'] = this.ajv;\n        window['_'] = _;\n        window.document.write(`\n          <script>\n              ${script}\n              ${loadSchemaCall};\n          </script>\n        `);\n        resolve(this.ajv);\n      } catch (e) {\n        reject(e);\n      }\n    });\n\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/definitions-loader.service.ts","module.exports = require(\"@angular/http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/http\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 4\n// module chunks = 0","import { Injector, OpaqueToken, NgModule, APP_INITIALIZER } from '@angular/core';\nimport { DoubleAgentValidator } from './validator.service';\nimport { DoubleAgentValidatorNg2Factory } from './ng2-factory.service';\n\nexport const DOUBLE_AGENT_VALIDATOR_SCHEMA_URL = new OpaqueToken('DoubleAgentValidator.SCHEMA_URL');\nexport const DOUBLE_AGENT_VALIDATOR_SCHEMA_NS = new OpaqueToken('DoubleAgentValidator.SCHEMA_NAMESPACES');\n@NgModule({\n  providers: [\n    DoubleAgentValidator,\n    DoubleAgentValidatorNg2Factory,\n    {\n      provide: APP_INITIALIZER,\n      useFactory: (injector: Injector, factory: DoubleAgentValidatorNg2Factory) => {\n        console.log('HERE', injector);\n        let url: string = injector.get(DOUBLE_AGENT_VALIDATOR_SCHEMA_URL);\n        let namespaces: string[] = injector.get(DOUBLE_AGENT_VALIDATOR_SCHEMA_NS);\n        return new Promise<void>((resolve, reject) => {\n          console.log('VALUES', url, namespaces);\n          let errors = null;\n          if (url == null) {\n            errors = 'DoubleAgentValidator Module needs an url provided through the DOUBLE_AGENT_VALIDATOR_SCHEMA_URL token';\n          }\n          if (namespaces == null) {\n            errors = `${errors ? errors : ''} DoubleAgentValidator Module needs the\n             namespaces provided through the DOUBLE_AGENT_VALIDATOR_SCHEMA_NS token`;\n          }\n          if (errors) {\n            reject(errors);\n          }\n          return factory.load(url, namespaces);\n        });\n      },\n      deps: [\n        Injector,\n        DoubleAgentValidatorNg2Factory,\n        DoubleAgentValidator\n      ]\n    }\n  ],\n  exports: [  ]\n})\nexport class DoubleAgentValidatorModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/validator.module.ts","import { Http } from '@angular/http';\nimport { DoubleAgentValidator } from './validator.service';\nimport { Angular2RemoteLoader } from './remote-loaders/angular2-remote-loader';\nimport { ValidatorDefinitionsLoader } from './definitions-loader.service';\nimport { Injectable } from '@angular/core';\nimport * as ajvNsAndConstructor from 'ajv';\n\n@Injectable()\nexport class DoubleAgentValidatorNg2Factory {\n  constructor(private http: Http, private doubleAgentValidator: DoubleAgentValidator) {\n  }\n  load(url: string, namespaces: string[]): Promise<void> {\n    let remoteLoader = new Angular2RemoteLoader(this.http);\n    let validationsLoader = new ValidatorDefinitionsLoader(remoteLoader);\n    let iframe = document.createElement('iframe');\n    iframe.id = 'DoubleAgentValidator';\n    iframe.border = '0';\n    iframe.src = 'about:blank';\n    iframe.style.background = 'transparent';\n    iframe.style.width = '1px';\n    iframe.style.height = '1px';\n    (<any>iframe).sandbox = 'allow-scripts allow-same-origin';\n    document.body.appendChild(iframe);\n    let window = iframe.contentWindow;\n    return new Promise<void>((resolve, reject) => {\n      validationsLoader.load(window, url, namespaces).then((ajv: ajvNsAndConstructor.Ajv) => {\n        this.doubleAgentValidator['_ajv'] = ajv;\n        window['DoubleAgentValidator'] = this.doubleAgentValidator;\n        resolve(null);\n      },\n        (e) => {\n          reject('coudl not create the DoubleAgentValidator instance: ' + e);\n        });\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ng2-factory.service.ts","import { Injectable } from '@angular/core';\nimport { Http, Response } from '@angular/http';\nimport { RemoteLoader } from '../models/remote-loader';\nimport { Observable } from 'rxjs/Observable';\nimport 'rxjs/add/operator/toPromise';\n\n@Injectable()\nexport class Angular2RemoteLoader implements RemoteLoader {\n  constructor(private http: Http) { }\n\n  getScript(url: string) {\n    return new Promise((resolve, reject) => {\n      let observable: Observable<Response> = this.http.get(url);\n      observable.subscribe((response: Response) => {\n        resolve(response.text());\n      },\n      (error) => { /* error handling block*/\n          reject(error);\n      });\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/remote-loaders/angular2-remote-loader.ts","module.exports = require(\"ajv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ajv\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"rxjs/add/operator/toPromise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"rxjs/add/operator/toPromise\"\n// module id = 9\n// module chunks = 0","export * from './validator.service';\nexport * from './definitions-loader.service';\nexport * from './validator.module';\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts"],"sourceRoot":""}